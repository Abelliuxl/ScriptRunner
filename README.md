# ScriptRunner - 魔兽世界Lua脚本执行器

## 项目概述
ScriptRunner是一个功能完整的魔兽世界插件，允许玩家在游戏内创建、管理和执行自定义Lua脚本。

## 功能特性

### 🎯 核心功能
- **脚本管理**: 创建、编辑、删除、保存Lua脚本
- **多种执行模式**: 自动执行、延迟执行、手动执行
- **简化执行**: 依赖游戏本身的安全机制
- **图形界面**: 直观的UI管理界面
- **数据持久化**: 脚本数据自动保存

### 🛠️ 技术特性
- **模块化设计**: 清晰的代码架构
- **简化执行**: 基础语法验证和错误捕获
- **错误处理**: 完善的错误捕获和提示
- **命令行支持**: 丰富的斜杠命令

## 项目结构
```
ScriptRunner/
├── ScriptRunner.toc          # 插件配置文件
├── ScriptRunner.lua          # 主入口文件
└── Core/                     # 核心模块目录
    ├── Storage.lua           # 数据存储模块
    ├── Executor.lua          # 脚本执行引擎
    └── UI.lua                # 用户界面模块
```

## 安装使用

### 安装方法
1. 将整个`ScriptRunner`文件夹复制到魔兽世界插件目录
2. 重启游戏客户端
3. 在游戏中使用`/sr`命令打开管理界面

### 基本命令
```bash
/sr                      # 打开管理界面
/sr help                 # 显示帮助信息
/sr list                 # 列出所有脚本
/sr create 测试           # 创建名为"测试"的脚本
/sr run 测试              # 执行名为"测试"的脚本
/sr stats                 # 显示统计信息
```

### 调试命令
```bash
/srd                     # 切换调试模式
/srd test                # 运行测试脚本
/srd validate            # 验证所有脚本语法
```

## 使用示例

### 示例1: 创建问候脚本
1. 输入 `/sr create 问候`
2. 在界面中编辑代码：
```lua
local playerName = UnitName("player")
print("你好, " .. playerName .. "! 欢迎使用ScriptRunner!")
```
3. 设置为"自动执行"模式
4. 保存脚本

### 示例2: 创建战斗统计脚本
```lua
-- 简单的战斗统计示例
local damageDone = 0
local healingDone = 0

-- 监听战斗事件
local function OnCombatEvent(event, ...)
    print("战斗事件:", event)
end

-- 注册事件监听
-- 注意：这只是一个示例，实际使用需要正确的API
print("战斗统计脚本已加载")
```

### 示例3: 创建工具脚本
```lua
-- 快速换装工具示例
local equipmentSets = {
    ["PVE"] = "PVE套装",
    ["PVP"] = "PVP套装"
}

function QuickEquip(setName)
    if equipmentSets[setName] then
        print("切换到套装:", equipmentSets[setName])
        -- 实际换装逻辑需要使用正确的WoW API
    else
        print("未找到套装:", setName)
    end
end

print("快速换装工具已加载")
print("使用 QuickEquip('PVE') 或 QuickEquip('PVP') 切换套装")
```

## 安全机制

### 执行安全
- **依赖游戏安全机制**: 利用魔兽世界自带的脚本执行监控
- **基础语法验证**: 保存前检查代码语法正确性
- **错误捕获**: 使用pcall捕获执行错误
- **状态检查**: 执行前验证脚本启用状态

### 设计理念
插件采用简化设计，不过度限制脚本功能，让玩家自由发挥，同时依赖游戏本身的安全保护机制。

## 开发说明

### 模块说明
1. **Storage.lua**: 负责数据持久化和CRUD操作
2. **Executor.lua**: 负责简化的脚本执行
3. **UI.lua**: 负责图形界面的创建和管理
4. **ScriptRunner.lua**: 主入口，整合所有模块

### 扩展开发
插件预留了以下扩展接口：
- 脚本导出/导入功能
- 主题切换系统
- 执行日志查看
- 更复杂的执行调度

## 测试验证

### 基础功能测试
1. 插件加载测试：确认插件正常初始化
2. UI界面测试：验证界面正常显示和交互
3. 脚本创建测试：创建新脚本并保存
4. 脚本执行测试：手动执行脚本并查看结果
5. 自动执行测试：创建自动脚本并重载插件验证

### 安全性测试
1. 语法错误测试：输入错误的Lua语法
2. 执行错误测试：测试错误处理机制

## 版本信息
- **版本**: 1.0.0
- **作者**: Custom
- **支持游戏版本**: 11.0.7 (巨龙时代)
- **开发框架**: 魔兽世界Lua API

## 注意事项
1. 请仅在测试环境中使用，避免在生产环境中执行未知脚本
2. 定期备份重要的脚本数据
3. 遵守魔兽世界服务条款，不要使用脚本进行作弊
4. 如遇到问题，可使用调试命令进行故障排除

## 技术支持
如有问题或建议，请通过以下方式联系：
- 游戏内使用 `/srd validate` 检查脚本
- 查看聊天框的错误信息
- 检查插件文件完整性

---

**免责声明**: 本插件仅供学习和测试使用，请遵守游戏规则和法律法规。
