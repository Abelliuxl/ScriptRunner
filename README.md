# ScriptRunner - 游戏内自定义Lua脚本执行器 (Ace3版本)

## 概述

ScriptRunner是一个强大的魔兽世界插件，允许你在游戏内创建、编辑和执行自定义Lua脚本。本版本已完全迁移到Ace3框架，提供了更好的稳定性和用户体验。

## 功能特性

### 🎯 核心功能
- **脚本管理**: 创建、编辑、删除和组织Lua脚本
- **多种执行模式**: 手动执行、自动执行、延迟执行
- **安全执行**: 依赖游戏内置的安全机制执行脚本
- **脚本验证**: 语法检查和错误提示

### 🎨 用户界面
- **AceGUI界面**: 使用Ace3框架构建的现代化界面
- **标签页设计**: 脚本管理、执行历史、设置分离
- **实时编辑**: 即时保存和脚本状态更新
- **执行历史**: 查看脚本执行记录和结果

### 📊 数据管理
- **AceDB集成**: 可靠的数据持久化
- **导入导出**: 脚本数据的备份和迁移
- **配置文件**: 支持多角色配置
- **统计信息**: 详细的脚本使用统计

### 🔧 高级功能
- **事件系统**: 模块间通信和状态同步
- **批量操作**: 多脚本批量管理
- **搜索功能**: 快速查找脚本
- **调试模式**: 详细的执行日志

## 安装说明

1. 将ScriptRunner文件夹复制到 `World of Warcraft\_retail_\Interface\AddOns\` 目录
2. 重启游戏或重新加载界面
3. 插件将自动初始化并显示加载消息

## 使用方法

### 基本命令
```
/sr 或 /scriptrunner     - 打开管理界面
/sr help                  - 显示帮助信息
/sr config                - 打开配置界面
```

### 脚本管理
```
/sr create <名称>         - 创建新脚本
/sr delete <ID或名称>     - 删除脚本
/sr run <ID或名称>        - 执行脚本
/sr list                  - 列出所有脚本
/sr stats                 - 显示统计信息
```

### 数据管理
```
/sr export                 - 导出所有脚本
/sr import <数据>          - 导入脚本数据
```

### 调试命令
```
/srd                      - 切换调试模式
/srd validate             - 验证所有脚本
/srd test                 - 运行测试脚本
/srd reset                - 重置数据库
```

## 界面介绍

### 脚本管理标签页
- **左侧列表**: 显示所有脚本，包含状态和模式标识
- **右侧编辑器**: 编辑脚本名称、代码、执行模式等属性
- **操作按钮**: 保存、执行、删除脚本

### 执行历史标签页
- **历史记录**: 显示最近50次脚本执行记录
- **执行状态**: 成功/失败状态标识
- **结果信息**: 执行结果或错误信息

### 设置标签页
- **调试模式**: 启用/禁用调试输出
- **统计信息**: 查看脚本使用统计
- **数据操作**: 导出、验证脚本等

## 执行模式

### 手动执行 (Manual)
- 需要手动触发执行
- 适用于需要精确控制的脚本

### 自动执行 (Auto)
- 插件加载后每30秒自动执行一次
- 适用于需要定期运行的脚本

### 延迟执行 (Delay)
- 插件加载后延迟指定秒数执行一次
- 适用于需要延迟启动的脚本

## 脚本示例

### 基础脚本
```lua
-- 简单的问候脚本
print("Hello from ScriptRunner!")
```

### 游戏信息脚本
```lua
-- 显示当前角色信息
local playerName = UnitName("player")
local level = UnitLevel("player")
local class = UnitClass("player")

print(string.format("角色: %s, 等级: %d, 职业: %s", playerName, level, class))
```

### 实用工具脚本
```lua
-- 显示背包空间
local totalSlots = 0
local freeSlots = 0

for bag = 0, 4 do
    local slots = GetContainerNumSlots(bag)
    if slots > 0 then
        totalSlots = totalSlots + slots
        for slot = 1, slots do
            if not GetContainerItemLink(bag, slot) then
                freeSlots = freeSlots + 1
            end
        end
    end
end

print(string.format("背包空间: %d/%d", freeSlots, totalSlots))
```

## 配置选项

### 界面设置
- **主题选择**: 默认、深色、浅色主题
- **工具提示**: 显示/隐藏详细说明

### 插件设置
- **调试模式**: 显示详细的调试信息
- **启用状态**: 启用/禁用插件功能

## 数据存储

- **SavedVariables**: `ScriptRunnerDB`
- **配置分离**: 支持角色特定配置
- **数据备份**: 建议定期导出脚本数据

## 故障排除

### 常见问题

1. **插件无法加载**
   - 检查文件路径是否正确
   - 确保所有依赖文件完整
   - 查看错误日志信息

2. **脚本执行失败**
   - 检查脚本语法是否正确
   - 确认脚本已启用
   - 查看错误信息提示

3. **界面显示异常**
   - 尝试重新加载界面 (`/reload`)
   - 检查Ace3库文件是否完整

### 调试模式
启用调试模式可以获得更详细的错误信息：
```
/srd  -- 切换调试模式
```

## 版本历史

### v1.0.0 (Ace3版本)
- 完全迁移到Ace3框架
- 重构用户界面使用AceGUI
- 增强数据存储使用AceDB
- 添加事件系统支持
- 改进错误处理和调试功能
- 增加执行历史记录
- 优化配置管理

## 技术架构

### 框架依赖
- **AceAddon-3.0**: 插件基础框架
- **AceConsole-3.0**: 命令行处理
- **AceEvent-3.0**: 事件系统
- **AceDB-3.0**: 数据持久化
- **AceGUI-3.0**: 图形界面组件
- **AceConfig-3.0**: 配置选项界面

### 模块结构
- **ScriptRunner.lua**: 主插件文件
- **Core/Storage.lua**: 数据存储模块
- **Core/Executor.lua**: 脚本执行引擎
- **Core/UI.lua**: 用户界面模块

## 许可证

本插件基于开源许可证发布，允许自由使用和修改。

## 贡献

欢迎提交bug报告、功能建议和代码贡献。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 游戏内反馈
- 插件评论区
- 技术支持论坛

---

**注意**: 使用本插件执行脚本时，请遵守游戏服务条款，避免使用可能影响游戏公平性的脚本。
